#ifndef QUICKSORT_H
#define QUICKSORT_H
#include "InsetionSort.h"
#include "SortTestHelper.h"
#include <time.h>
#include <vector>


/*打算重新学习下算法，顺便把相关的东西整理到自己博客上，博客一搜重复的内容一大片，不论是正确还是错误的都带着很多主观看法，所以写这个不是为了成为参考资料，只为整理下自己的思路、备忘，如果被网路上的同学们检索到，希望大家能够自己甄别其中好坏，有问题的地方，也希望能够提出来大家共同学习。
这里从快速排序和归并排序开始，因为对于新入行的同学来讲，这两个排序是理解递归的一个很好的切入点。*/

// 直接进入主题，快排思想，就是把数组首位数字v放入数组有序时它该处的位置，同时使其左右数据满足如下描述性质:
// [|v|..................] ==> [....<v....|v|....>v.....]
// 这个步骤称之为partition，可以发现经过一次partition，v的序列位定下来了,同时其他的数据虽然没有排好序，但是至少处在它该处的区间。
// 然后对<v和>v的区间再次进行partition（递归），可以预见区间被划分得越来越多也越来越小，数据被分割得越来越精确（接近它的序列位）
// 最后完全停留在它的序列位上，此时整个数组有序。
// 类似于二分法，此数组理想情况下被分割的次数是logN，每次分割后，遍历数据量为N，时间复杂度NlogN。
// 此时可以写出快排伪代码：

int _partition(int a[], int lo, int hi);
void _quicksort(int a[], int lo, int hi){
	if (lo >= hi)
		return;
	int j = _partition(a, lo, hi);
	_quicksort(a, lo, j - 1);
	_quicksort(a, j + 1, hi);
}

// 看起来道理很简单是不是？我们只需要实现核心算法partition就可以了，partition过程中区间处于以下状态：
// [(v, lo) | .....<v..... | i......j | .....>v.....hi]

// 其中索引上i、j参数需要明确它们的含义：
// i：右遍历指针，满足[lo, i) < v
// j：左遍历指针，满足(j, hi] > v
// 由i和j来找出v的序列位

//那么问题来了，整个递归结构很清晰，但是前（启动partition：各个参数初始值）、后（退出partition：退出条件）两个部分如何分析？
int _partition(int a[], int lo, int hi){
	int i = lo;
	int j = hi + 1;
	int v = a[lo];
	while(true){
		while(a[++i] < v){ 
			if (i >= hi) break;
		}
		while(a[--j] > v){
			if (j <= lo) break;
		}
		if (i >= j)		// ">=" 还是 ">" ？
			break;
		swap(a[i], a[j]);
	}
	swap(a[lo], a[j]);
	return j;
}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
void quicksort(int a[], int n){
	_quicksort(a, 0, n - 1);
}
void testQuickSort(){
	int n = 10000;
	int* arr = SortTestHelper::generateRandomArray(n, 0, n);
	SortTestHelper::testSort("Quick Sort", quicksort, arr, n);
}









#endif //QUICKSORT_H